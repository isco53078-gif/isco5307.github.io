<script src="https://unpkg.com/intasend-inlinejs-sdk@3.0.4/build/intasend-inline.js"></script>

<style>
    .service-card { border: 1px solid #ccc; padding: 20px; border-radius: 10px; margin-bottom: 20px; font-family: sans-serif; background: #fff; }
    .form-group { margin-bottom: 15px; }
    label { display: block; font-weight: bold; margin-bottom: 5px; }
    input, select { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ddd; box-sizing: border-box; }
    .pay-btn { background: #28a745; color: white; padding: 15px; width: 100%; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; font-size: 1.1em; }
    .result-area { display: none; margin-top: 20px; padding: 15px; background: #e9f7ef; border-left: 5px solid #28a745; }
</style>

<div class="service-card">
    <h2>1. IscoTech Academy Enrollment</h2>
    <p>Fee: KES 20</p>
    <div class="form-group">
        <label>Full Name:</label>
        <input type="text" id="aca_name" placeholder="Enter your name">
    </div>
    <div class="form-group">
        <label>Select Your Desired Course:</label>
        <select id="aca_course">
            <option>Python Masterclass</option>
            <option>Web Development (HTML/CSS/JS)</option>
            <option>Graphic Design</option>
            <option>Computer Packages</option>
            <option>Cyber Security Basics</option>
        </select>
    </div>
    <div class="form-group">
        <label>M-Pesa Number:</label>
        <input type="number" id="aca_phone" placeholder="2547XXXXXXXX">
    </div>
    <button class="pay-btn" onclick="handlePayment(20, 'aca_phone', 'aca_result')">SUBMIT & PAY KES 20</button>
    
    <div id="aca_result" class="result-area">
        <h3>Enrollment Successful! ✅</h3>
        <p>Your details have been received. We will contact you on WhatsApp for your login credentials.</p>
    </div>
</div>

<div class="service-card">
    <h2>2. Career AI & Grade Analysis</h2>
    <p>Fee: KES 50</p>
    <div class="form-group">
        <label>Student Name:</label>
        <input type="text" id="car_name" placeholder="Enter name">
    </div>
    <div class="form-group">
        <label>Mean Grade:</label>
        <select id="car_grade">
            <option value="C">C (Plain)</option>
            <option value="C-">C- (Minus)</option>
            <option value="D">D (Plain/Plus)</option>
        </select>
    </div>
    <div class="form-group">
        <label>Best Subject:</label>
        <input type="text" id="car_subject" placeholder="e.g. Mathematics">
    </div>
    <div class="form-group">
        <label>M-Pesa Number:</label>
        <input type="number" id="car_phone" placeholder="2547XXXXXXXX">
    </div>
    <button class="pay-btn" onclick="handlePayment(50, 'car_phone', 'car_result', 'career')">SUBMIT & UNLOCK CAREER PATHS</button>
    
    <div id="car_result" class="result-area">
        <h3>Career Analysis Ready ✅</h3>
        <ul id="career_list"></ul>
    </div>
</div>

<div class="service-card">
    <h2>3. KRA PIN Registration/Update</h2>
    <p>Fee: KES 20</p>
    <div class="form-group">
        <label>ID Number:</label>
        <input type="number" id="kra_id" placeholder="Enter ID">
    </div>
    <div class="form-group">
        <label>Full Location (County/Town):</label>
        <input type="text" id="kra_loc" placeholder="e.g. Homa Bay, Ndhiwa">
    </div>
    <div class="form-group">
        <label>Date of Birth:</label>
        <input type="date" id="kra_dob">
    </div>
    <div class="form-group">
        <label>Active Email Address:</label>
        <input type="email" id="kra_email" placeholder="email@example.com">
    </div>
    <div class="form-group">
        <label>M-Pesa Number for Payment:</label>
        <input type="number" id="kra_phone" placeholder="2547XXXXXXXX">
    </div>
    <button class="pay-btn" onclick="handlePayment(20, 'kra_phone', 'kra_result')">SUBMIT & PAY KES 20</button>
    
    <div id="kra_result" class="result-area">
        <h3>Application Received! ✅</h3>
        <p>Your KRA details are being processed. Your PIN certificate will be sent to the email provided within 24 hours.</p>
    </div>
</div>

<script>
    const intasend = new window.IntaSend({
        publicAPIKey: "ISPubKey_live_546f4dab-3bfd-45d1-9c94-cb3d3767e690",
        live: true 
    });

    function handlePayment(amt, phoneId, resultId, type) {
        const phone = document.getElementById(phoneId).value;
        if (!phone || phone.length < 10) { alert("Please enter a valid M-Pesa number"); return; }

        intasend.run({
            amount: amt,
            currency: "KES",
            phone_number: phone,
            method: "M-PESA",
            api_ref: "448941" // Your Account Number
        })
        .on("COMPLETE", (results) => {
            document.getElementById(resultId).style.display = "block";
            if(type === 'career') generateCareerList();
            alert("Payment Successful!");
        })
        .on("FAILED", () => alert("Payment failed. Please try again."));
    }

    function generateCareerList() {
        const grade = document.getElementById('car_grade').value;
        const list = document.getElementById('career_list');
        let courses = grade === "C" ? 
            ["Dip. ICT", "Dip. Nursing", "Dip. Clinical Medicine", "Dip. Software Engineering", "Dip. Pharmacy", "Dip. Mechanical Eng", "Dip. Law"] :
            ["Cert. ICT", "Dip. Health Records", "Cert. Plumbing", "Dip. Automotive Eng", "Cert. Electrical", "Dip. Community Health", "Cert. Masonry"];
        
        list.innerHTML = "";
        courses.forEach(c => list.innerHTML += "<li><b>" + c + "</b></li>");
    }
</script>
